<!DOCTYPE html>
<html lang="en">

<head>
    <title>FaceAPI Live WebCam Demo</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, shrink-to-fit=yes">
    <meta name="application-name" content="FaceAPI">
    <meta name="keywords" content="FaceAPI">
    <meta name="description"
        content="FaceAPI: AI-powered Face Detection, Description & Recognition for Browser and NodeJS using Tensorflow/JS">
    <meta name="msapplication-tooltip"
        content="FaceAPI: AI-powered Face Detection, Description & Recognition for Browser and NodeJS using Tensorflow/JS">
    <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">
    <script src="./index.js" type="module"></script>
    <script src="./poseDetection.js" type="module"></script>

    <link rel="stylesheet" type="text/css" href="styles.css">

    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-core"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/face_detection" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-converter"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-backend-webgl"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/pose-detection"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/selfie_segmentation"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/pose"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/body-segmentation"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/14.6.4/nouislider.min.js"></script>
    <script async src="filters/opencv.js" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.14.0/Sortable.min.js"></script>
</head>

<body>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/14.6.4/nouislider.min.css">
   
    <div id="sidePanel" class="side-panel">
        <button id="closePanelButton" class="panel-button close-button">&times;</button>

        <label class="checkbox-label"> Camera Orientation
            <select id="videoAngle">
                <option value="0">0</option>
                <option value="90">90°</option>
                <option value="180">180°</option>
                <option value="270">270°</option>
            </select>
        </label>
        <label >
            <input type="checkbox" id="mirrorCheckbox" checked> Mirror
            
        </label>
        <label class="checkbox-label"> Face vs Skeleton
            <select id="appVersion">
                <option value="face">Face</option>
                <option value="skeleton">Skeleton</option>
            </select>
        </label>
        <div id="gap" min="0" max="10" step="2" value="2" label="Frame Gap"></div>
        <div id="pixelSmooth" min="0.1" max="1" step=".1" value=".2" label="Pixel Smoothing"></div>

        <label>
            <input type="checkbox" id="bgSeg" checked> Background Segmentation
        </label>
        <div id="bg" min="-1" max="1" step=".1" value="1" label="Background Col"></div>
        <div id="minEyeDist" min="0" max="500" step="1" value="20" label="Min Eye Dist"></div>
        <label>
            <input type="checkbox" id="faceCentered" checked> Center Face
        </label>
        <div id="centeringSpeed" min="1" max="45" step="1" value="25" label="Centering Speed"></div>
        <div id="centeringLeeway" min="0" max="2" step=".1" value=".6" label="Centering Leeway"></div>

        <label>
            <input type="checkbox" id="autoEV" checked> Auto-adjust EV
        </label>
        </label>
        <div id="brightnessRange" min="0" max="255" step="1" lowValue="115" highValue="150" label="Brightness"></div>
        <label>
            <div id="exposureModeWrapper">
                <label for="exposureModeSelect">Exposure Mode:
                <select id="exposureModeSelect">
                    <option value="manual">Manual</option>
                    <option value="continuous">Continuous</option>
                </select>
            </label>
            </div>
            <div id="exposureCompWrapper">
                <div id="exposureComp" min="0" max="255" step="1" value="0" label="EV"></div>
                <div id="exposureTime" min="0" max="1250" step="1" value="150" label="Exposure t (ms)"></div>
            </div>
        <div class="group">
            <div class="group-header">ROI <span class="toggle-button">+</span></div>
            <div class="group-content">
                <div id="roi" min="0.1" max="10" step=".1" value="2.4" label="ROI"></div>
                <div id="roiXOffset" min="-1" max="1" step=".1" value="0" label="ROI X offset"></div>
                <div id="roiYOffset" min="-1" max="1" step=".1" value="0" label="ROI Y offset"></div>
                <label>
                    <input type="checkbox" id="outerRoi"> Show Outer ROI
                </label>
                <div id="outerROIWidth" min="0" max="1000" step="1" value="500" label="Outer ROI Width"></div>
                <div id="outerROIHeight" min="0" max="1000" step="1" value="500" label="Outer ROI Height"></div>
            </div>
        </div>
        <div class="group">
            <div class="group-header">Two Camera Fading <span class="toggle-button">+</span></div>
            <div class="group-content">
                <label class="checkbox-label"> Fade Colour
                    <select id="fadeColour">
                        <option value="black">black</option>
                        <option value="white">white</option>
                    </select>
                </label>
                <div id="fadeDur" min="200" max="2000" step="1" value="1000" label="Fade Dur (ms)"></div>
                <div id="switchDur" min="2" max="30" step="1" value="15" label="Switch Dur (s)"></div>
                <div id="pauseDur" min=".5" max="5" step=".5" value="1" label="Pause dur (s)"></div>
                </div>
            </div>
        <div class="group">
            <div class="group-header" >Filters <span class="toggle-button">+</span></div>
            <div class="group-content">
                <label>
                    <input type="checkbox" id="histogramEqCheckbox"> Histogram Eq
                </label>
                <label>
                    <input type="checkbox" id="clahe" checked> Clahe
                </label>
                <div id="clahe-sliders">
                    <div id="clipLimit" min="1" max="10" step=".1" value="3" label="Clip Limit"></div>
                    <div id="tileSize" min="1" max="64" step="4" value="8" label="Tile Size"></div>
                </div>
                <label>
                    <input type="checkbox" id="edge"> Sharpening Filter
                </label>
                <div id="edgeStrength" min="0" max="1" step=".1" value=".5" label="Edge Strength"></div>
                <label>
                    <input type="checkbox" id="sobel"> Sobel Edge Detection
                </label>
                <div id="sobEdgeStrength" min="0" max="1" step=".1" value=".3" label="Edge Strength" ></div>
                <label>
                    <input type="checkbox" id="robert" checked> Robert Edge Detection
                </label>
                <div id="robEdgeStrength" min="0" max="1" step=".1" value=".1" label="Edge Strength" ></div>

                <div id="contrast" min="-100" max="100" step="1" value="50" label="Contrast" ></div>
                <div id="gamma" min="0" max="2" step=".1" value="1" label="Gamma" ></div>
                <div id="grayscaleSlider" min="0" max="255" step="1" lowValue="0" highValue="255" label="Grayscale Range"></div>
                <div id="grayscaleMapSlider" min="0" max="255" step="1" lowValue="0" highValue="255" label="GR (with remap)"></div>
                <div id="grayscaleExpoSlider" min="0" max="255" step="1" lowValue="0" highValue="255" label="GR (with expo)"></div>
                <div id="grayExpo" min="1" max="3" step="1" value="1" label="Expo" ></div>
                <div id="contrastEnh" min="0" max="255" step="1" lowValue="0" highValue="255" label="Contrast Enhancement"></div>
                
                </label>
                    <label>Filter Order:</label>
                    <ul id="functionOrderList">
                        <li data-function="contrast">Contrast</li>
                        <li data-function="histoEq">Histogram Eq</li>
                        <li data-function="clahe">CLAHE</li>
                        <li data-function="sharpen">Sharpen</li>
                        <li data-function="sobel">Sobel</li>
                        <li data-function="robert">Robert</li>
                    </ul>
                    <script>
                        const functionOrderList = document.getElementById('functionOrderList');
                        Sortable.create(functionOrderList, {
                            animation: 150,
                            onEnd: () => {
                                console.log('List order updated');
                            }
                        });
                    </script>
                </div>
            </div>
            <div class="group">
                <div class="group-header">DMX Tests <span class="toggle-button">+</span></div>
                <div class="group-content">
                    <label><input type="checkbox" id="screensaver">Screensaver</label>
                    <div id="animSpeed" min=".1" max="5" step=".1" value="1" label="Animation Speed"></div>

                    <label><input type="checkbox" id="blackScreen">Black Screen</label>
                    <label><input type="checkbox" id="whiteScreen">White Screen</label>
                    
                </div>
            </div>
            <div class="group">
                <div class="group-header">Camera Filters <span class="toggle-button">+</span></div>
                <div class="group-content">
                    <div id="camBrightness" min="-64" max="64" step="1" value="0" label="Cam Brightness"></div>
                    <div id="camContrast" min="0" max="100" step="1" value="100" label="Cam Contrast"></div>
                    <div id="camSaturation" min="0" max="100" step="1" value="50" label="Cam Saturation"></div>
                    <div id="camSharpness" min="0" max="100" step="1" value="71" label="Cam Sharpness"></div>
                    <div id="camGain" min="1" max="128" step="1" value="56" label="Cam Gain"></div>
                    <div id="camBacklight" min="0" max="2" step=".1" value="1" label="Cam Backlight"></div>
                    <div id="whiteBalanceMode">
                        <label for="WhiteBalanceModeSelect">Cam White Balance Mode:</label>
                        <select id="WhiteBalanceModeSelect">
                            <option value="manual">Manual</option>
                            <option value="continuous" selected>Continuous</option>
                        </select>
                    </div>
                    <div id="colourTempContainer" style="display: none;">
                        <div id="colourTemp" min="2800" max="6500" step="50" value="5500" label="Cam Colour Temp"></div>
                    </div>
                </div>
            </div>

    </div>
    <div id="top">
        <div class="video-container" >
            <div class = "video-inner-container">
            <video class="video"></video>
            <canvas class="black-canvas"></canvas>
            <canvas class="canvas"></canvas>
            <button class="play-pause-button">
                <span class="play-icon" style="display: none">&#9654;</span>
                <span class="pause-icon">&#10074;&#10074;</span>
            </button>
            <div class="fps-display"></div>
        </div>
            
            <div class="canvas-container">
                <div class="canvas-wrapper">
                    <canvas class="gray-canvas" width="150" height="150"></canvas>
                </div>
                <div class="canvas-wrapper">
                    <canvas class="cropped-canvas" width="150" height="150"></canvas>
                </div>
                <div class="canvas-wrapper">
                    <canvas class="pixel-canvas" width="150" height="150"></canvas>
                </div>
            </div>
        </div>
        <div class="video-container">
            <div class = "video-inner-container">
                <video class="video"></video>
                <canvas class="black-canvas"></canvas>
                <canvas class="canvas"></canvas>
                <button class="play-pause-button">
                    <span class="play-icon" style="display: none">&#9654;</span>
                    <span class="pause-icon">&#10074;&#10074;</span>
                </button>
                <div class="fps-display"></div>
            </div>
            <div class="canvas-container">
                <div class="canvas-wrapper">
                    <canvas class="gray-canvas" width="150" height="150"></canvas>
                </div>
                <div class="canvas-wrapper">
                    <canvas class="cropped-canvas" width="150" height="150"></canvas>
                </div>
                <div class="canvas-wrapper">
                    <canvas class="pixel-canvas" width="150" height="150"></canvas>
                </div>
            </div>
        </div>
        <div class = "dmxGridWrapper">
            <div class="dmxGrid" id="dmx1"></div>
            <div class="dmxGrid" id="dmx2"></div>
            <div class="dmxGrid" id="dmx3"></div>
        </div>
    </div>
</body>
</html>